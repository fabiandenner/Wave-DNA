\chapter{Change of variables}
\label{chap:Appendix}

Due to the rather large number of terms in the transformed wave equation, it is advantageous to derive it in two steps, leading to a hierarchy of coefficients. By first expanding the material derivatives in Eq. \eqref{eq:convectiveKuznetsov}, one gets
\begin{equation}
    \mathcal{A}_1 \dfrac{\partial \phi_1}{\partial t}
    + \mathcal{A}_2 \dfrac{\partial^2 \phi_1}{\partial t^2}
    + \mathcal{K} \dfrac{\partial \phi_1}{\partial t}\dfrac{\partial^2 \phi_1}{\partial t^2}
    + \mathcal{A}_G \dfrac{\partial \phi_1}{\partial r} - \dfrac{c_0^2}{A}\dfrac{\partial A}{\partial r} \dfrac{\partial \phi_1}{\partial r} + \mathcal{A}_L \dfrac{\partial^2 \phi_1}{\partial r^2}
    + \mathcal{U} = 0,
    \label{eq:convectiveKuznetsov_AAA}
\end{equation}
where the coefficients in Eq. \eqref{eq:convectiveKuznetsov_AAA} are given by
\begin{align}
     & \mathcal{A}_1 = \mathcal{K}\left(\mathcal{U} + u_0^2\dfrac{\partial^2\phi_1}{\partial r^2}\right),
    \label{eq:A1}                                                                                                                                                           \\
     & \mathcal{A}_2 = 1 + \mathcal{K}u_0\dfrac{\partial \phi_1}{\partial r},
    \label{eq:A2}                                                                                                                                                           \\
     & \mathcal{A}_G = \dfrac{\partial u_0}{\partial r}\dfrac{\partial \phi_1}{\partial r} + 2\dfrac{\partial^2 \phi_1}{\partial r\partial t} + \mathcal{K}u_0 \mathcal{U},
    \label{eq:AG}                                                                                                                                                           \\
     & \mathcal{A}_L = u_0^2 - c_0^2 + 2u_0\dfrac{\partial \phi_1}{\partial r} + \mathcal{K}u_0^3\dfrac{\partial \phi_1}{\partial r},
    \label{eq:AL}
\end{align}
and where
\begin{equation}
    \mathcal{K} = \dfrac{2\left(\beta - 1\right)}{c_0^2},
    \label{eq:Kcoeff}
\end{equation}
and
\begin{equation}
    \mathcal{U} = 2u_0\dfrac{\partial^2 \phi_1}{\partial x\partial t} + \dfrac{\mathrm{D}u_0}{\mathrm{D}t}\dfrac{\partial\phi_1}{\partial r}.
    \label{eq:Uterm}
\end{equation}
are recurring auxiliary variables. Following \citet{Solovchuk_et_al_2013}, the nonlinear term in Eq. \eqref{eq:convectiveKuznetsov_AAA} is linearized by applying the Newton linearization
\begin{equation}
    \dfrac{\partial \phi_1}{\partial t}\dfrac{\partial^2 \phi_1}{\partial t^2} \approx
    \left(\dfrac{\partial \phi_1}{\partial t}\right)^o\dfrac{\partial^2 \phi_1}{\partial t^2}
    +
    \left(\dfrac{\partial^2 \phi_1}{\partial t^2}\right)^o\dfrac{\partial \phi_1}{\partial t}
    - \left(\dfrac{\partial \phi_1}{\partial t}\right)^o\left(\dfrac{\partial^2 \phi_1}{\partial t^2}\right)^o.
    \label{eq:NewtonLin}
\end{equation}
In a second step, Eqs. \eqref{eq:transDerivativeOp_space} and \eqref{eq:transDerivativeOp_time} are applied to Eq. \eqref{eq:convectiveKuznetsov_AAA} in order to change the variables from $r$ to $\xi$. This results in the transformed wave equation
\begin{equation}
    \mathcal{B}_1 \dfrac{\partial \Phi_1}{\partial t}
    + \mathcal{B}_2 \dfrac{\partial^2 \Phi_1}{\partial t^2}
    + 2\mathcal{B}_2 \dfrac{\partial \xi}{\partial t} \dfrac{\partial^2 \Phi_1}{\partial \xi\partial t}
    + \mathcal{B}_G \dfrac{\partial \Phi_1}{\partial \xi}
    + \mathcal{B}_L \dfrac{\partial^2 \Phi_1}{\partial \xi^2}
    - \dfrac{c_0^2}{A}\dfrac{\partial A}{\partial r} \dfrac{\partial \xi}{\partial r}\dfrac{\partial \Phi_1}{\partial \xi}
    + \mathcal{U}
    - \mathcal{K}\left(\dfrac{\partial \phi_1}{\partial t}\right)^o\left(\dfrac{\partial^2 \phi_1}{\partial t^2}\right)^o
    = 0
    \label{eq:convectiveKuznetsov_BBB}
\end{equation}
with the coefficients
\begin{align}
     & \mathcal{B}_1 = \mathcal{A}_1 + \mathcal{K}\left(\dfrac{\partial^2 \phi_1}{\partial t^2}\right)^o,
    \label{eq:B1}                                                                                                                                   \\
     & \mathcal{B}_2 = \mathcal{A}_2 + \mathcal{K}\left(\dfrac{\partial \phi_1}{\partial t}\right)^o,
    \label{eq:B2}                                                                                                                                   \\
     & \mathcal{B}_G =
    \mathcal{B}_1\dfrac{\partial \xi}{\partial t}
    + \mathcal{B}_2\left(\dfrac{\partial^2\xi}{\partial t^2} + \dfrac{\partial \xi}{\partial t} \dfrac{\partial^2\xi}{\partial t\partial \xi}\right)
    + \dfrac{\partial \xi}{\partial r}\left(\mathcal{A}_G
    + \mathcal{A}_L\dfrac{\partial^2\xi}{\partial r\partial \xi}\right),
    \label{eq:BG}                                                                                                                                   \\
     & \mathcal{B}_L = \mathcal{B}_2\left(\dfrac{\partial \xi}{\partial t}\right)^2 + \mathcal{A}_L\left(\dfrac{\partial \xi}{\partial r}\right)^2,
    \label{eq:BL}
\end{align}
which again depend on the coefficients $\mathcal{A}_{...}$ given by Eqs. \eqref{eq:A1} to \eqref{eq:AL} derived in the previous step. In the present numerical framework, the mixed spatial-temporal derivative in Eq. \eqref{eq:convectiveKuznetsov_BBB} is treated fully explicitly. However, it turns out be beneficial regarding the numerical accuracy to substitute the term by the following equivalent expression prior to the discretization. The equivalent expression is obtained by expanding $\partial^2\left(\Phi_1\partial\xi/\partial t\right)/\partial \xi \partial t$, resulting in
\begin{equation}
    \dfrac{\partial \xi}{\partial t} \dfrac{\partial^2 \Phi_1}{\partial \xi\partial t}
    = \dfrac{1}{2}\dfrac{\partial \xi}{\partial t} \dfrac{\partial^2 \Phi_1}{\partial \xi\partial t} +
    \dfrac{1}{2}\left[
        \dfrac{\partial^2}{\partial \xi\partial t}\left(\dfrac{\partial \xi}{\partial t}\Phi_1\right)
        - \dfrac{\partial^2 \xi}{\partial t^2 \partial \xi} \dfrac{\partial \Phi_1}{\partial \xi}
        - \dfrac{\partial^3 \xi}{\partial t^2\partial \xi}\Phi_1
        - \dfrac{\partial^2 \xi}{\partial t \partial \xi} \dfrac{\partial \Phi_1}{\partial t}\right].
    \label{eq:mixedTerm}
\end{equation}
